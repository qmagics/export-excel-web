function t(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function n(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?t(Object(o),!0).forEach((function(t){r(n,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(o,t))}))}return n}function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function r(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function o(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,o,c=[],a=!0,i=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(c.push(r.value),!n||c.length!==n);a=!0);}catch(t){i=!0,o=t}finally{try{a||null==e.return||e.return()}finally{if(i)throw o}}return c}(t,n)||a(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,n){if(t){if("string"==typeof t)return i(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?i(t,n):void 0}}function i(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var l="image",u={"font-family":"宋体","font-size":"11pt"},f={"text-align":"center","vertical-align":"middle"},s="Sheet1",p="文件",d=100,h=100,m=function(t){return"object"===e(t)?Object.entries(t).map((function(t){var n=o(t,2),e=n[0],r=n[1];return r?"".concat(e,":").concat(r):""})).filter((function(t){return!!t})).join(";")+";":t},y=function(t,e,r,o,c){var a=r.type,i=r.cellStyle,u=r.width,s=r.imageHeight,p=r.imageWidth,y=void 0;y="function"==typeof i?i({value:t,row:e,rowIndex:o,columnIndex:c}):i;var b=n(n({},f),{},{width:u?u+"px":""},y),w={};return a===l&&(w.width=function(t,n){return t?"number"==typeof t?t:"function"==typeof t?t(n):void 0:h}(p,{value:t,row:e,column:r,rowIndex:o,columnIndex:c}),w.height=function(t,n){return t?"number"==typeof t?t:"function"==typeof t?t(n):void 0:d}(s,{value:t,row:e,column:r,rowIndex:o,columnIndex:c}),b.height=w.width+"px",u||(b.width=w.width+"px")),{cellStyle:m(b),imageProps:w}},b=function(t,n,e,r,o){var c=n.type,a=function(t,n,e,r){var o=n.formatter,c=t[n.prop]||"";return"function"!=typeof o?c:o({value:c,row:t,rowIndex:e,columnIndex:r})}(t,n,e,r),i=y(a,t,n,e,r),u=i.cellStyle,f=i.imageProps,s=function(t,n){if("function"!=typeof t)return"";var e=t(n);if(!e)return"";var r=e.rowspan,o=e.colspan;return{content:'rowspan="'.concat(r,'" colspan="').concat(o,'"'),needDelete:0===r&&0===o}}(o,{row:t,column:n,rowIndex:e,columnIndex:r}),p=s.content;return s.needDelete?"":a?c===l?"<td ".concat(p,' style="').concat(u,'"><img src="').concat(a,'" width="').concat(f.width,'" height="').concat(f.height,'" /></td>'):"<td ".concat(p,' style="').concat(u,'"><span>').concat(a,"</span></td>"):"<td ".concat(p,' style="').concat(u,'"></td>')},w=function(t){var n=t.row,e=t.rowIndex,r=t.rowHeight;if(!r)return"";var o="";return"number"==typeof r?o=r:"function"==typeof r&&(o=r({row:n,rowIndex:e})),'height="'.concat(o,'"')},v=function(t){var n=t.map((function(t){var n=t.label,e=t.width,r=t.style,o=m(r),c=function(t){var n=t.rowspan,e=t.colspan;return 0===e&&0===n?"":"".concat(e?'colspan="'+e+'"':""," ").concat(n?'rowspan="'+n+'"':"")}(t);return"<th ".concat(c,' style="').concat(o,'" width="').concat(e,'"> ').concat(n," </th>")}));return"<tr>".concat(n.join(""),"</tr>")},x=function(t){var e,r=t.table,o=t.sheetName,c=t.fileName,a=t.style,i={worksheet:o||s,table:r,style:m(n(n({},u),a))},l=document.createElement("a");l.setAttribute("href","data:application/vnd.ms-excel;base64,"+function(t){return window.btoa(unescape(encodeURIComponent(t)))}((e=i,'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n        <head>\n            <meta charset="UTF-8">\n            \x3c!--[if gte mso 9]>\n            <xml>\n                <x:ExcelWorkbook>\n                    <x:ExcelWorksheets>\n                        <x:ExcelWorksheet>\n                            <x:Name>{worksheet}</x:Name>\n                            <x:WorksheetOptions>\n                                <x:DisplayGridlines/>\n                            </x:WorksheetOptions>\n                        </x:ExcelWorksheet>\n                    </x:ExcelWorksheets>\n                </x:ExcelWorkbook>\n            </xml>\n            <![endif]--\x3e\n        </head>\n        <body>\n            <table style="{style}">{table}</table>\n        </body>\n    </html>'.replace(/{(\w+)}/g,(function(t,n){return e[n]}))))),l.setAttribute("download",c||p),l.click()},g=function(t,n){var e=t.map((function(t){var n=t.label,e=t.width,r=t.style,o=t.tag,c=void 0===o?"td":o,a=t.align,i=void 0===a?"center":a,l=m(r),u=function(t){var n=t.colspan,e=t.rowspan;return 0===n&&0===e?"":"".concat(n?'colspan="'+n+'"':""," ").concat(e?'rowspan="'+e+'"':"")}(t);return"<".concat(c," ").concat(u,' align="').concat(i,'" style="').concat(l,'" width="').concat(e,'"> ').concat(n," </").concat(c,">")}));return"<".concat(n,"><tr>").concat(e.join(""),"</tr></").concat(n,">")},j=function(t){var n=t.columns,e=t.data,r=t.fileName,o=t.sheetName,a=t.style,i=t.spanMethod,l=t.topRows,u=void 0===l?[]:l,f=t.bottomRows,s=void 0===f?[]:f,p=t.rowHeight,d=t.showHeader,h=void 0===d||d,m=function(t){var n=[],e=[];!function t(e,r){var o;n[e]=[];var a=[];r.forEach((function(t){var r;t.colspan=1,t.depth=e,t.hasChildren=!(null===(r=t.children)||void 0===r||!r.length),t.hasChildren&&(t.children.forEach((function(n){n.parent=t})),t.colspan=0,a=[].concat(c(a),c(t.children))),delete t.children,n[e].push(t)})),null!==(o=a)&&void 0!==o&&o.length&&t(e+1,a)}(0,t);for(var r=n.length-1,o=function(t){var o=n[t],c=[];o.forEach((function(n){var e=n.parent,o=n.hasChildren,a=n.colspan,i=n.depth;e&&(n.parent.colspan+=a),o||(n.rowspan=r-t+1),o&&i!==r||c.push(n)})),e.unshift.apply(e,c)},a=r;a>=0;a--)o(a);return{columnsGroup:n,bodyColumns:e}}(n),y=m.columnsGroup,j=m.bodyColumns,O=h?function(t){var n=t.map((function(t){return v(t)}));return"<thead>".concat(n.join(""),"</thead>")}(y):"",I=function(t,n,e,r){for(var o="<tbody>",c=n.length,a=t.length,i=0;i<c;i++){var l=n[i],u=w({row:l,rowIndex:i,rowHeight:r});o+="<tr ".concat(u,">");for(var f=0;f<a;f++){var s=t[f];o+=b(l,s,i,f,e)}o+="</tr>"}return o+"</tbody>"}(j,e,i,p),S=(u||[]).map((function(t){return g(t,"thead")})).join(""),E=(s||[]).map((function(t){return g(t,"tfoot")})).join("");x({table:S+O+I+E,fileName:r,sheetName:o,style:a})};export{j as default};
//# sourceMappingURL=index.esm.js.map
